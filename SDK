#include "xil_io.h"
#include "xparameters.h"
#include <stdint.h>

#define NCO_BASEADDR XPAR_IP_NCO_0_S00_AXI_BASEADDR
#define NCO_CLK      100000000.0    // 100 MHz

uint32_t calc_freq_word(double fout)
{
    double fw = fout * (double)0x100000000 / NCO_CLK; // 2^32
    return (uint32_t)fw;
}

int main()
{
    double target_freq = 1000.0;   // muốn tạo 1 kHz
    uint32_t freq_word = calc_freq_word(target_freq);

    xil_printf("Freq word = %u\r\n", freq_word);

    Xil_Out32(NCO_BASEADDR, freq_word);

    xil_printf("NCO updated to %f Hz\r\n", target_freq);

    while(1);
    return 0;
}
